<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pyramid Card Game - Multiplayer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Alfa+Slab+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="menu-screen" class="screen active">
        <h1>üÉè Pyramid Card Game</h1>
        <div class="rules" id="rules">Rules</div>
        <button onclick="showHostScreen()">Host New Game</button>
        <button onclick="showJoinScreen()">Join Game</button>
    </div>

    <div id="host-screen" class="screen">
        <h1>Host New Game</h1>
        <label>Your Name:</label>
        <input type="text" id="host-name" value="Host">
        <button onclick="hostGame()" id="host-btn">Create Game</button>
        <button onclick="showMenuScreen()">Back</button>
        <div id="host-info" style="display:none;">
            <div class="connection-info">
                <h3>Game Created!</h3>
                <p>Share this code:</p>
                <div class="game-code" id="host-game-code">...</div>
            </div>
            <div class="players-list">
                <h4>Players in Game:</h4>
                <div id="host-players-list"></div>
            </div>
            <button onclick="startHostedGame()" id="start-game-btn" disabled>Start Game</button>
        </div>
    </div>

    <div id="join-screen" class="screen">
        <h1>Join Game</h1>
        <label>Your Name:</label>
        <input type="text" id="join-name" value="Player">
        <label>Game Code:</label>
        <input type="text" id="game-code-input" style="text-transform:uppercase;">
        <button onclick="joinGame()" id="join-btn">Join</button>
        <button onclick="showMenuScreen()">Back</button>
        <div id="join-info" style="display:none;">
            <div class="connection-info">
                <h3>Joined Game!</h3>
                <p>Waiting for host...</p>
            </div>
            <div class="players-list">
                <h4>Players in Game:</h4>
                <div id="join-players-list"></div>
            </div>
        </div>
    </div>

    <div id="game-screen" class="screen">
        <div id="game-controls">
            <div id="current-turn">Setting Up...</div>
            <div id="phase-display">Phase: Setup</div>
            <div id="timer-display">Time: <span id="countdown">30</span>s</div>
            <div id="current-card-display" style="display:none;">
                Card: <span id="current-card"></span>
            </div>
            <div class="phase-actions">
                <button onclick="autoStart()" id="auto-start-btn" style="display:none;">Deal Cards</button>
                <button onclick="startMemorizePhase()" id="memorize-btn" style="display:none;">Start Memorizing</button>
                <button onclick="nextPyramidCard()" id="pyramid-btn" style="display:none;">Flip Next Card</button>
                <button onclick="startRecall()" id="recall-btn" style="display:none;">Start Recall Phase</button>
            </div>
            <div id="prove-card-prompt" class="prove-prompt" style="display: none;"></div>
        </div>
        <div id="table-container">
            <div id="table">
                <div id="pyramid" class="pyramid"></div>
            </div>
        </div>
        <div id="connection-status" class="connection-status disconnected">...</div>
            <div id="chat-widget">
                <div id="chat-messages"></div>
                <form id="chat-form" onsubmit="sendChatMessage(event)">
                    <input type="text" id="chat-input" placeholder="Send a message..." autocomplete="off">
                </form>
            </div>
        </div>
    </div>

    <div id="target-modal" class="modal">
        <div class="modal-content">
            <h3 id="target-message">Choose someone to drink</h3>
            <div id="target-buttons" class="modal-buttons"></div>
        </div>
    </div>

    <div id="bluff-modal" class="modal">
        <div class="modal-content">
            <h3 id="bluff-message">...</h3>
            <p>Do you want to drink or call their bluff?</p>
            <div class="modal-buttons">
                <button class="accept-btn" onclick="acceptDrink()">Take Drink</button>
                <button class="challenge-btn" onclick="callBluff()">Call Bluff!</button>
            </div>
        </div>
    </div>
        <div class="rules" id="rules">Rules</div>
        <div class="scroll-widget" onclick="openRules(event)">
            <div id="rules-modal" class="modal" onclick="closeRules(event)">
              <div class="modal-content" onclick="event.stopPropagation()">
                <span class="close" onclick="closeRules(event)">&times;</span>
                <pre id="rules-text">Loading...</pre>
              </div>
            </div>
            <div class="scroll-icon">
                <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <filter id="drop-shadow" x="-50%" y="-50%" width="200%" height="200%">
                            <feDropShadow dx="3" dy="5" stdDeviation="3" flood-color="#000" flood-opacity="0.4"/>
                        </filter>
                    </defs>
                    <g style="filter: url(#drop-shadow);">
                        <rect x="10" y="5" width="15" height="90" rx="7" fill="#6b4f34"/>
                        <rect x="75" y="5" width="15" height="90" rx="7" fill="#6b4f34"/>
                        <rect x="5" y="10" width="25" height="10" rx="5" fill="#4a3c28"/>
                        <rect x="70" y="10" width="25" height="10" rx="5" fill="#4a3c28"/>
                        <rect x="5" y="80" width="25" height="10" rx="5" fill="#4a3c28"/>
                        <rect x="70" y="80" width="25" height="10" rx="5" fill="#4a3c28"/>
                        <rect x="25" y="10" width="50" height="80" fill="#f3e5ab"/>
                    </g>
                </svg>
            </div>
        </div>

    <div id="game-message" class="game-message"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    <script src="script.js"></script>      
</body>
</html>
